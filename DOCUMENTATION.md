# Documentation Strategy

This project exposes several web components written in TypeScript and Rust. Interactive examples are useful for demonstrating how each component behaves, so Markdown files alone are not sufficient. The following approach uses free hosting on GitHub Pages, automatically scrapes documentation comments, and lets us write higher level guides.

## Overview

- **Docs site**: [Docusaurus](https://docusaurus.io/) generates a static site that can be hosted for free on GitHub Pages. It supports MDX so we can create custom pages with embedded examples or tutorials.
- **Interactive demos**: [Storybook](https://storybook.js.org/) showcases each component with live controls. Storybook can be built to static HTML and integrated into the Docusaurus site (for example via an iframe) or linked as a separate section.
- **API docs**: [TypeDoc](https://typedoc.org/) together with the `@custom-elements-manifest/analyzer` plugin extracts documentation from the JSDoc comments in the source. The generated docs are added to the Docusaurus site automatically.
- **Hosting**: GitHub Pages serves the static site from the `gh-pages` branch. A GitHub Actions workflow builds the documentation and deploys on every push to `master`.

## Repository Changes

1. **Add documentation dependencies**
   ```bash
   npm install --save-dev @docusaurus/core @docusaurus/preset-classic @docusaurus/plugin-content-docs @docusaurus/plugin-content-pages @docusaurus/plugin-content-blog @docusaurus/theme-live-codeblock typedoc docusaurus-plugin-typedoc @custom-elements-manifest/analyzer storybook @storybook/web-components @storybook/addon-docs
   ```
   This installs Docusaurus, TypeDoc, the custom elements manifest analyzer, and Storybook with the docs addon.

2. **Create the Docusaurus site**
   ```bash
   npx create-docusaurus@latest docs classic
   ```
   The generated `docs` directory will contain the site source. Update `docusaurus.config.js` to include the `typedoc` plugin and any custom styling.

3. **Generate the custom elements manifest and API docs**
   Add scripts in `package.json`:
   ```json
   {
     "scripts": {
       "docs:manifest": "cem analyze --lite --outFile custom-elements.json",
       "docs:api": "typedoc --out docs/api src/index.ts",
       "docs:storybook": "storybook build --docs",
       "docs:build": "npm run docs:manifest && npm run docs:api && npm run docs:storybook && docusaurus build docs"
     }
   }
   ```
   - `cem analyze` extracts metadata from components into `custom-elements.json`.
   - `typedoc` generates markdown documentation in `docs/api`.
   - `storybook build` creates static pages for component demos.
   - `docusaurus build` assembles the final documentation site.

4. **Write manual pages and stories**
   - Add MDX files under `docs/docs` for tutorials or usage guides.
   - Create a `stories` directory and write a story for each web component so that users can interact with them. Storybook automatically uses the manifest data to display property tables.

5. **Configure GitHub Actions deployment**
   Add `.github/workflows/docs.yml`:
   ```yaml
   name: Deploy Docs
   on:
     push:
       branches: ["master"]
   jobs:
     build-deploy:
       runs-on: ubuntu-latest
       steps:
         - uses: actions/checkout@v3
         - uses: actions/setup-node@v3
           with:
             node-version: 22
         - run: npm ci
         - run: npm run docs:build
         - name: Deploy
           uses: peaceiris/actions-gh-pages@v3
           with:
             publish_dir: ./build
             publish_branch: gh-pages
             github_token: ${{ secrets.GITHUB_TOKEN }}
   ```
   The workflow installs dependencies, builds the documentation, and publishes the contents of the `build` directory (generated by Docusaurus) to the `gh-pages` branch whenever code lands on `master`.

6. **Enable GitHub Pages**
   In the repository settings, choose the `gh-pages` branch as the source for GitHub Pages. After the first deployment the site will be available under `https://<username>.github.io/<repository>/`.

7. **Keeping docs up to date**
   - Document new components with JSDoc comments.
   - Add or update stories for every component so users can experiment with the props.
   - Write tutorial pages under `docs/docs` when new functionality is added.

## Updating Existing Repositories

1. Commit the new `docs` folder and `custom-elements.json` to source control (ignore `build` output).
2. Commit the new workflow file.
3. Push to `master` and verify that the GitHub Actions workflow finishes successfully and publishes the site.
4. Future pushes to `master` will redeploy automatically.

The combination of Docusaurus, Storybook, and automatic API generation provides a rich documentation site while remaining completely free to host using GitHub Pages.
